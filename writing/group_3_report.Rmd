---
title: "Group 3 Final Project"
author: "Natalie Collins, Peter Kessinger, MacKenzie Hennes, & Audrey Dickinson"
date: "11/16/2020"
output:
  flexdashboard::flex_dashboard: default
---
 Column {data-width=600}
-------------------------------------
  
### Larimer County COVID-19 Outbreaks 
  
```{r}
library(tidyverse)
library(flexdashboard)
library(lubridate)
library(shiny)
library(jsonlite)
library(maptools)
library(leaflet)
library(plotly)
library(DT)
library(ggthemes)
library(viridis)

outbreak_list <- read.csv(file = "larimer_covid_outbreaks.csv" )
outbreak_list <- outbreak_list %>%
  select(Facility, Status, Type, Date.Outbreak.Determined)

datatable(outbreak_list, colnames = c("Location", "Status", "Company Type", "Start Outbreak Date"), extensions = "Scroller", style="bootstrap", class="compact", width="100%", options=list(deferRender=TRUE, scrollY=300, scroller=TRUE))
```

Column {data-width=400}
-------------------------------------
  
### Covid-19 Outbreaks by Month
```{r}
outbreak_dates <- outbreak_list %>% 
  mutate(Date.Outbreak.Determined = mdy(Date.Outbreak.Determined)) %>%  
  mutate(month(Date.Outbreak.Determined, label = TRUE)) %>% 
  rename(start_month = `month(Date.Outbreak.Determined, label = TRUE)`)

outbreak_graph <- outbreak_dates %>% 
  ggplot(aes(x = start_month)) +
  geom_bar(fill = "darkcyan") +
  theme_few() +
  labs(x = "Month Outbreak Started", y = "Number of Outbreaks", 
       title = "Community Covid-19 Outbreaks by Month")
  

outbreak_graph
```

### Outbreak Gauge




### Confirmed Cases

```{r}
case_data <- read_csv("larimer_covid_cases.csv") %>% 
  group_by(Type) %>% 
  count() %>% 
  filter(Type == "Confirmed")

valueBox(case_data$n ,caption = "Confirmed Cases", icon = "fa-group")

```

### Confirmed Deaths

```{r}
death_data <- read_csv("larimer_covid_deaths.csv")

death_data <- death_data %>% 
  group_by(case_status) %>% 
  count() %>% 
  filter(case_status == "Confirmed")

valueBox(death_data$n ,caption = "Confirmed Deaths", icon = "fa-medkit")
```