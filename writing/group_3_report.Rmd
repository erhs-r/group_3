---
title: "Group 3 Final Project"
author: "Natalie Collins"
date: "11/16/2020"
output: flexdashboard::flex_dashboard
---
 Column {data-width=600}
-------------------------------------
  
### Larimer County COVID-19 Outbreaks 
  
```{r}
library(tidyverse)
library(flexdashboard)
library(lubridate)
library(shiny)
library(jsonlite)
library(maptools)
library(leaflet)
library(plotly)
library(DT)
library(ggthemes)
library(viridis)
outbreak_list <- read.csv(file = "https://larimer-county-data-lake.s3-us-west-2.amazonaws.com/Public/covid/covid_outbreak.csv?t=1606767494752" )
outbreak_list <- outbreak_list %>%
  select(Facility, Status, Type, Date.Outbreak.Determined)


datatable(outbreak_list, colnames = c("Location", "Status", "Company Type", "Start Outbreak Date"), extensions = "Scroller", style="bootstrap", class="compact", width="100%", options=list(deferRender=TRUE, scrollY=300, scroller=TRUE))
```

Column {data-width=400}
-------------------------------------
  
### Chart 2
```{r}
outbreak_dates <- outbreak_list %>% 
  mutate(Date.Outbreak.Determined = ymd(Date.Outbreak.Determined)) %>% mutate(month(Date.Outbreak.Determined, label = TRUE)) %>% 
  rename(start_month = `month(Date.Outbreak.Determined, label = TRUE)`)

outbreak_graph <- outbreak_dates %>% 
  ggplot(aes(x = start_month)) +
  geom_bar() +
  theme_few()+
  labs(x = "Month Outbreak Started", y = "Number of Outbreaks", 
       title = "Community Covid-19 Outbreaks by Month")
  

outbreak_graph
```

### Chart 3


### Articles per Day

```{r}
case_data <- read_csv("https://speedtest.larimer.org/covid/index.php?t=1606853343384&gid=1219297132&csv=cases") %>% 
  group_by(Type) %>% 
  count() %>% 
  filter(Type == "Confirmed")

valueBox(case_data$n ,caption = "Confirmed Cases", icon = "fa-virus")
```

### Comments per Day

```{r}
death_data <- read_csv("https://larimer-county-data-lake.s3-us-west-2.amazonaws.com/Public/covid/covid_deaths.csv?t=1606853343384")

death_data <- death_data %>% 
  group_by(case_status) %>% 
  count() %>% 
  filter(case_status == "Confirmed")

valueBox(death_data$n ,caption = "Confirmed Deaths", icon = "fa-virus")
```